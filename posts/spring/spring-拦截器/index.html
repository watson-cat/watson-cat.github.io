<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>JavaWEB笔记-Spring拦截器 | 学習のメモ</title><meta name=keywords content="java,note,spring"><meta name=description content="入门案例 定义一个拦截器Bean,实现HandlerInterceptor接口
@Component public class UserInterceptor implements HandlerInterceptor { //拦截之前触发 @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(&#34;preHandle&#34;); //返回false表示不放行 中止原始操作, 也会影响拦截器链的运行 return true; } //拦截之后触发 @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(&#34;postHandle&#34;); HandlerInterceptor.super.postHandle(request, response, handler, modelAndView); } //拦截完成后触发 @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(&#34;afterCompletion&#34;); HandlerInterceptor.super.afterCompletion(request, response, handler, ex); } } 定义配置类, 继承WebMvcConfigurationSupport实现addInterceptors()方法 或者 在SpringMvcConfig里实现WebMvcConfigurer接口"><meta name=author content="Eoezora"><link rel=canonical href=https://eoezora.github.io/posts/spring/spring-%E6%8B%A6%E6%88%AA%E5%99%A8/><link crossorigin=anonymous href=/assets/css/stylesheet.284aabc5722191b1dcad9bb63113b81b1a333af91d23376e20229f78210e57c0.css integrity="sha256-KEqrxXIhkbHcrZu2MRO4GxozOvkdIzduICKfeCEOV8A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f48fb8860a5c615479d2828e0069ff11741ea1b73bb4d97bac263fcb19684da2.js integrity="sha256-9I+4hgpcYVR50oKOAGn/EXQeobc7tNl7rCY/yxloTaI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://eoezora.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://eoezora.github.io/favicon-16x16.ico><link rel=icon type=image/png sizes=32x32 href=https://eoezora.github.io/favicon-32x32.ico><link rel=apple-touch-icon href=https://eoezora.github.io/apple-touch-icon.png><link rel=mask-icon href=https://eoezora.github.io/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@600&display=swap" rel=stylesheet><meta property="og:title" content="JavaWEB笔记-Spring拦截器"><meta property="og:description" content="入门案例 定义一个拦截器Bean,实现HandlerInterceptor接口
@Component public class UserInterceptor implements HandlerInterceptor { //拦截之前触发 @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(&#34;preHandle&#34;); //返回false表示不放行 中止原始操作, 也会影响拦截器链的运行 return true; } //拦截之后触发 @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(&#34;postHandle&#34;); HandlerInterceptor.super.postHandle(request, response, handler, modelAndView); } //拦截完成后触发 @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(&#34;afterCompletion&#34;); HandlerInterceptor.super.afterCompletion(request, response, handler, ex); } } 定义配置类, 继承WebMvcConfigurationSupport实现addInterceptors()方法 或者 在SpringMvcConfig里实现WebMvcConfigurer接口"><meta property="og:type" content="article"><meta property="og:url" content="https://eoezora.github.io/posts/spring/spring-%E6%8B%A6%E6%88%AA%E5%99%A8/"><meta property="og:image" content="https://eoezora.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-13T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-13T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://eoezora.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="JavaWEB笔记-Spring拦截器"><meta name=twitter:description content="入门案例 定义一个拦截器Bean,实现HandlerInterceptor接口
@Component public class UserInterceptor implements HandlerInterceptor { //拦截之前触发 @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(&#34;preHandle&#34;); //返回false表示不放行 中止原始操作, 也会影响拦截器链的运行 return true; } //拦截之后触发 @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(&#34;postHandle&#34;); HandlerInterceptor.super.postHandle(request, response, handler, modelAndView); } //拦截完成后触发 @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(&#34;afterCompletion&#34;); HandlerInterceptor.super.afterCompletion(request, response, handler, ex); } } 定义配置类, 继承WebMvcConfigurationSupport实现addInterceptors()方法 或者 在SpringMvcConfig里实现WebMvcConfigurer接口"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://eoezora.github.io/posts/"},{"@type":"ListItem","position":2,"name":"JavaWEB笔记-Spring拦截器","item":"https://eoezora.github.io/posts/spring/spring-%E6%8B%A6%E6%88%AA%E5%99%A8/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"JavaWEB笔记-Spring拦截器","name":"JavaWEB笔记-Spring拦截器","description":"入门案例 定义一个拦截器Bean,实现HandlerInterceptor接口\n@Component public class UserInterceptor implements HandlerInterceptor { //拦截之前触发 @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(\u0026#34;preHandle\u0026#34;); //返回false表示不放行 中止原始操作, 也会影响拦截器链的运行 return true; } //拦截之后触发 @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(\u0026#34;postHandle\u0026#34;); HandlerInterceptor.super.postHandle(request, response, handler, modelAndView); } //拦截完成后触发 @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(\u0026#34;afterCompletion\u0026#34;); HandlerInterceptor.super.afterCompletion(request, response, handler, ex); } } 定义配置类, 继承WebMvcConfigurationSupport实现addInterceptors()方法 或者 在SpringMvcConfig里实现WebMvcConfigurer接口","keywords":["java","note","spring"],"articleBody":"入门案例 定义一个拦截器Bean,实现HandlerInterceptor接口\n@Component public class UserInterceptor implements HandlerInterceptor { //拦截之前触发 @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(\"preHandle\"); //返回false表示不放行 中止原始操作, 也会影响拦截器链的运行 return true; } //拦截之后触发 @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(\"postHandle\"); HandlerInterceptor.super.postHandle(request, response, handler, modelAndView); } //拦截完成后触发 @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(\"afterCompletion\"); HandlerInterceptor.super.afterCompletion(request, response, handler, ex); } } 定义配置类, 继承WebMvcConfigurationSupport实现addInterceptors()方法 或者 在SpringMvcConfig里实现WebMvcConfigurer接口\n继承WebMvcConfigurationSupport的方式\n@Configuration public class SpringMVCSupport extends WebMvcConfigurationSupport { @Autowired private UserInterceptor userInterceptor; //静态资源过滤 @Override protected void addResourceHandlers(ResourceHandlerRegistry registry) { //当访问/pages/xxx时,走/pages目录里的内容 registry.addResourceHandler(\"/pages/**\").addResourceLocations(\"/pages/\"); } //注册拦截器 @Override protected void addInterceptors(InterceptorRegistry registry) { //访问 /users 时拦截 registry.addInterceptor(userInterceptor1).addPathPatterns(\"/users\",\"/users/*\"); //如果有多个拦截器,只要这边再次添加即可 registry.addInterceptor(userInterceptor2).addPathPatterns(\"/users\",\"/users/*\"); registry.addInterceptor(userInterceptor3).addPathPatterns(\"/users\",\"/users/*\"); registry.addInterceptor(userInterceptor4).addPathPatterns(\"/users\",\"/users/*\"); //上述拦截器执行顺序 1 -\u003e 2 -\u003e 3 -\u003e 4 与你的代码书写顺序挂钩, 如果上面代码里 userInterceptor4写在userInterceptor3前面那执行顺序就变成了 1 -\u003e 2 -\u003e 4 -\u003e 3 //上方多个拦截器的执行顺序根据你上面书写的顺序有关. 且拦截器里的三个方法遵循先进后出,后进先出的规则, 与Servlet的过滤器一致 } } 实现WebMvcConfigurer接口的方式(此方法侵入式较强, 与Spring绑定)\n@Configuration @ComponentScan({\"com.eoezora.controller\", \"com.eoezora.exception\", \"com.eoezora.interceptor\"}) @EnableWebMvc public class SpringMVCConfig implements WebMvcConfigurer { @Autowired private UserInterceptor userInterceptor; @Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(userInterceptor).addPathPatterns(\"/users\", \"/users/*\"); } @Override public void addResourceHandlers(ResourceHandlerRegistry registry) { registry.addResourceHandler(\"/pages/**\").addResourceLocations(\"/pages/\"); } } 两者方式都一样, 只是写的地方不同而已\n拦截器参数 处理器: @Controller里的方法\nboolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler)\n返回值: 当返回值为false时, 被拦截的处理器将不再执行 postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)\nModelAndView modelAndView: 如果处理器执行完成后有返回结果, 可以根据modelAndView读取对应数据与页面信息,并进行调整 afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)\nException ex: 如果处理器遇到异常,可以针对异常进行处理 这个三个方法共有的参数\nHttpServletRequest request: 请求对象, 可以根据这个获取该次请求的请求数据 HttpServletResponse response: 响应对象，可以根据这个获取该次请求的响应数据 Object handler: 被调用的处理器对象,本质是一个方法, 对反射技术中的Method进行封装 ","wordCount":"221","inLanguage":"en","datePublished":"2022-10-13T00:00:00Z","dateModified":"2022-10-13T00:00:00Z","author":{"@type":"Person","name":"Eoezora"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://eoezora.github.io/posts/spring/spring-%E6%8B%A6%E6%88%AA%E5%99%A8/"},"publisher":{"@type":"Organization","name":"学習のメモ","logo":{"@type":"ImageObject","url":"https://eoezora.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://eoezora.github.io/ accesskey=h title="学習のメモ (Alt + H)">学習のメモ</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://eoezora.github.io/archives/ title=📚文章><span>📚文章</span></a></li><li><a href=https://eoezora.github.io/search/ title=🔍搜索><span>🔍搜索</span></a></li><li><a href=https://eoezora.github.io/tags/ title=🔖Tags><span>🔖Tags</span></a></li><li><a href=https://eoezora.github.io/about/ title=🙋🏻‍♂️关于><span>🙋🏻‍♂️关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://eoezora.github.io/>主页</a>&nbsp;»&nbsp;<a href=https://eoezora.github.io/posts/>Posts</a></div><h1 class=post-title>JavaWEB笔记-Spring拦截器</h1><div class=post-meta><span title='2022-10-13 00:00:00 +0000 UTC'>October 13, 2022</span>&nbsp;·&nbsp;2 分钟&nbsp;·&nbsp;221 字&nbsp;·&nbsp;Eoezora</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e5%85%a5%e9%97%a8%e6%a1%88%e4%be%8b aria-label=入门案例>入门案例</a></li><li><a href=#%e6%8b%a6%e6%88%aa%e5%99%a8%e5%8f%82%e6%95%b0 aria-label=拦截器参数>拦截器参数</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=入门案例>入门案例<a hidden class=anchor aria-hidden=true href=#入门案例>#</a></h2><p>定义一个拦截器Bean,实现<strong>HandlerInterceptor</strong>接口</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Component</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserInterceptor</span> <span class=kd>implements</span> <span class=n>HandlerInterceptor</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//拦截之前触发
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>preHandle</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>request</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>response</span><span class=o>,</span> <span class=n>Object</span> <span class=n>handler</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;preHandle&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//返回false表示不放行 中止原始操作, 也会影响拦截器链的运行
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//拦截之后触发
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>postHandle</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>request</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>response</span><span class=o>,</span> <span class=n>Object</span> <span class=n>handler</span><span class=o>,</span> <span class=n>ModelAndView</span> <span class=n>modelAndView</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;postHandle&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>HandlerInterceptor</span><span class=o>.</span><span class=na>super</span><span class=o>.</span><span class=na>postHandle</span><span class=o>(</span><span class=n>request</span><span class=o>,</span> <span class=n>response</span><span class=o>,</span> <span class=n>handler</span><span class=o>,</span> <span class=n>modelAndView</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//拦截完成后触发
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>afterCompletion</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>request</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>response</span><span class=o>,</span> <span class=n>Object</span> <span class=n>handler</span><span class=o>,</span> <span class=n>Exception</span> <span class=n>ex</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;afterCompletion&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>HandlerInterceptor</span><span class=o>.</span><span class=na>super</span><span class=o>.</span><span class=na>afterCompletion</span><span class=o>(</span><span class=n>request</span><span class=o>,</span> <span class=n>response</span><span class=o>,</span> <span class=n>handler</span><span class=o>,</span> <span class=n>ex</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>定义配置类, 继承<strong>WebMvcConfigurationSupport</strong>实现<strong>addInterceptors()<strong>方法 或者 在SpringMvcConfig里实现</strong>WebMvcConfigurer</strong>接口</p><p>继承WebMvcConfigurationSupport的方式</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SpringMVCSupport</span> <span class=kd>extends</span> <span class=n>WebMvcConfigurationSupport</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>UserInterceptor</span> <span class=n>userInterceptor</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//静态资源过滤
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>addResourceHandlers</span><span class=o>(</span><span class=n>ResourceHandlerRegistry</span> <span class=n>registry</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//当访问/pages/xxx时,走/pages目录里的内容
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>registry</span><span class=o>.</span><span class=na>addResourceHandler</span><span class=o>(</span><span class=s>&#34;/pages/**&#34;</span><span class=o>).</span><span class=na>addResourceLocations</span><span class=o>(</span><span class=s>&#34;/pages/&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//注册拦截器
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>addInterceptors</span><span class=o>(</span><span class=n>InterceptorRegistry</span> <span class=n>registry</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//访问 /users 时拦截
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>registry</span><span class=o>.</span><span class=na>addInterceptor</span><span class=o>(</span><span class=n>userInterceptor1</span><span class=o>).</span><span class=na>addPathPatterns</span><span class=o>(</span><span class=s>&#34;/users&#34;</span><span class=o>,</span><span class=s>&#34;/users/*&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//如果有多个拦截器,只要这边再次添加即可
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>registry</span><span class=o>.</span><span class=na>addInterceptor</span><span class=o>(</span><span class=n>userInterceptor2</span><span class=o>).</span><span class=na>addPathPatterns</span><span class=o>(</span><span class=s>&#34;/users&#34;</span><span class=o>,</span><span class=s>&#34;/users/*&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>registry</span><span class=o>.</span><span class=na>addInterceptor</span><span class=o>(</span><span class=n>userInterceptor3</span><span class=o>).</span><span class=na>addPathPatterns</span><span class=o>(</span><span class=s>&#34;/users&#34;</span><span class=o>,</span><span class=s>&#34;/users/*&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>registry</span><span class=o>.</span><span class=na>addInterceptor</span><span class=o>(</span><span class=n>userInterceptor4</span><span class=o>).</span><span class=na>addPathPatterns</span><span class=o>(</span><span class=s>&#34;/users&#34;</span><span class=o>,</span><span class=s>&#34;/users/*&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//上述拦截器执行顺序 1 -&gt; 2 -&gt; 3 -&gt; 4  与你的代码书写顺序挂钩, 如果上面代码里 userInterceptor4写在userInterceptor3前面那执行顺序就变成了  1 -&gt; 2 -&gt; 4 -&gt; 3 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//上方多个拦截器的执行顺序根据你上面书写的顺序有关. 且拦截器里的三个方法遵循先进后出,后进先出的规则, 与Servlet的过滤器一致
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>实现<strong>WebMvcConfigurer</strong>接口的方式(此方法侵入式较强, 与Spring绑定)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span>
</span></span><span class=line><span class=cl><span class=nd>@ComponentScan</span><span class=o>({</span><span class=s>&#34;com.eoezora.controller&#34;</span><span class=o>,</span> <span class=s>&#34;com.eoezora.exception&#34;</span><span class=o>,</span> <span class=s>&#34;com.eoezora.interceptor&#34;</span><span class=o>})</span>
</span></span><span class=line><span class=cl><span class=nd>@EnableWebMvc</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SpringMVCConfig</span> <span class=kd>implements</span> <span class=n>WebMvcConfigurer</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>UserInterceptor</span> <span class=n>userInterceptor</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>addInterceptors</span><span class=o>(</span><span class=n>InterceptorRegistry</span> <span class=n>registry</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>registry</span><span class=o>.</span><span class=na>addInterceptor</span><span class=o>(</span><span class=n>userInterceptor</span><span class=o>).</span><span class=na>addPathPatterns</span><span class=o>(</span><span class=s>&#34;/users&#34;</span><span class=o>,</span> <span class=s>&#34;/users/*&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>addResourceHandlers</span><span class=o>(</span><span class=n>ResourceHandlerRegistry</span> <span class=n>registry</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>registry</span><span class=o>.</span><span class=na>addResourceHandler</span><span class=o>(</span><span class=s>&#34;/pages/**&#34;</span><span class=o>).</span><span class=na>addResourceLocations</span><span class=o>(</span><span class=s>&#34;/pages/&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>两者方式都一样, 只是写的地方不同而已</p><h2 id=拦截器参数>拦截器参数<a hidden class=anchor aria-hidden=true href=#拦截器参数>#</a></h2><blockquote><p><strong>处理器: @Controller里的方法</strong></p></blockquote><p><strong>boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler)</strong></p><ul><li>返回值: 当返回值为false时, 被拦截的处理器将不再执行</li></ul><p><strong>postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</strong></p><ul><li>ModelAndView modelAndView: 如果处理器执行完成后有返回结果, 可以根据modelAndView读取对应数据与页面信息,并进行调整</li></ul><p><strong>afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</strong></p><ul><li>Exception ex: 如果处理器遇到异常,可以针对异常进行处理</li></ul><p><strong>这个三个方法共有的参数</strong></p><ul><li>HttpServletRequest request: 请求对象, 可以根据这个获取该次请求的<strong>请求数据</strong></li><li>HttpServletResponse response: 响应对象，可以根据这个获取该次请求的<strong>响应数据</strong></li><li>Object handler: 被调用的处理器对象,本质是一个方法, 对反射技术中的Method进行封装</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://eoezora.github.io/tags/java/>java</a></li><li><a href=https://eoezora.github.io/tags/note/>note</a></li><li><a href=https://eoezora.github.io/tags/spring/>spring</a></li></ul><nav class=paginav><a class=prev href=https://eoezora.github.io/posts/spring/spring-boot/><span class=title>« 上一页</span><br><span>JavaWEB笔记-SpringBoot</span></a>
<a class=next href=https://eoezora.github.io/posts/spring/spring-%E6%95%B4%E5%90%88mybatis/><span class=title>下一页 »</span><br><span>JavaWEB笔记-Spring整合mybatis</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://eoezora.github.io/>学習のメモ</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>